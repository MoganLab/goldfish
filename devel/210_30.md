# [210_30] 

## 2026/02/27  限定 boot.scm 中 R7RS 的模式启用条件
### What
启动条件调整：
在 `boot.scm` 中将 `scheme-version` 设为 `r7rs` 的行为改为条件启用：
仅当 `(not (defined? 'texmacs-module))` 时执行。
兼容性保护：
在 `TeXmacs` 内嵌运行场景下，不再强制切换到 r7rs。
运行语义分流：
独立 Goldfish：保持/启用 r7rs 行为；
TeXmacs 内核：保持原有 TeXmacs module 体系与加载语义。
### Why
无条件启用 r7rs 会改变 import/库定位行为，影响 TeXmacs 插件初始化链路。
TeXmacs 启动流程本身依赖 texmacs-module 机制，强制切换方言会引入加载回归（如菜单渲染阶段触发的插件初始化异常）。
通过环境感知（是否定义 texmacs-module）分流，可同时满足独立 Goldfish 的 R7RS 使用需求与 TeXmacs 兼容性。
### How
条件判断：
使用 `(defined? 'texmacs-module)` 识别当前是否处于 TeXmacs 运行上下文。
条件执行：
仅在 texmacs-module 未定义时执行：
```
(set! (*s7* 'scheme-version) 'r7rs)。
```
最终语义：
TeXmacs 内：不改 scheme-version，避免扰动现有模块系统；
独立运行：启用 r7rs，继续使用 Goldfish 期望的方言行为。
